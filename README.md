# ViralCellDetector
This R script can be used to detect virus contamination in any sample. It takes the input as raw RNA-seq reads as input and provide the list of putative viruses as output. The final virus could be visualized by the igv genome viewer. 

## Installation
```
git clone https://github.com/Bin-Chen-Lab/ViralCellDetector

## Then go to the ViralCellDetector directory:
cd ViralCellDetector
```
# Usage
First user need to run the Genome_index.sh bash code do download their respective host genome and annotation files. Users need to edit the "Genome_file.txt" by providing the "ftp" for host sample genome and annotation file. For examples we have added the ftp link for human genome and its annotation file.
ftp://ftp.ebi.ac.uk/pub/databases/gencode/Gencode_human/release_29/GRCh38.primary_assembly.genome.fa.gz
ftp://ftp.ebi.ac.uk/pub/databases/gencode/Gencode_human/release_29/gencode.v29.annotation.gtf.gz
Then, they need to run the following bash command to generate the host reference genome index file and viral index file. We have already added the viral genomes download link from NCBI in the bash command.
```r
bash Genome_index.sh Genome_file.txt
## This will download the reference host genome and Viral genomes and create the index files required for the script.
````

To use the script, users will need to have R and the dplyr, data.table, and tdyr packages installed. Users need to create a fastq directory in the ViralCellDetector folder and transfer all their fastqu file in the fastq directory. AFter that they can create the list of names of all the fastq files and add into the sample_input.txt file. If a fastq input file is "input_file_1.fq and input_file_2.fq", then "sample_input.txt" file should have "input_file" name in first row. Once users have the dependencies and other direcoty setup, they can run the script by calling following code
``` r
## basic example code
Rscript ViralCellDetector.R sample_input.txt
## 
```

# Input

The script takes as input as RNA-seq raw sequencing fastq file, Users need to create a fastq directory in the ViralCellDector directory and put all their fastq files in the fastq directory. Then user need to creat a sample_input.txt file and enter all fastq files name in it. If fastq files are paired end then their only name should be provided in sample_input.txt as mentioned in example code. The ViralCellDetector prefer to accept the RNA-seq data generated by the robominus approach, however user can also use the RNA-seq raw reads generated by poly-A enrichment approach.

# Output

The script will output a list of names of putative viruses with their mapping length, size, and number of reads mapped on its genome, which are supposed to be present in the samples. 

# Note

Please make sure that the sequencing reads are with good quality.

# Dependencies

The script requires the following R packages and tools to be installed:
samtools (https://github.com/samtools/samtools/)

STAR (https://github.com/alexdobin/STAR)

BWA (https://bio-bwa.sourceforge.net/)

dplyr (https://dplyr.tidyverse.org/)

data.table()

tidyr



Make sure these packages are installed before running the script.

# Example

To run the example files, we have provided a example code:

```r
Run_test_ViralCellDetector.sh
```
# Contributors

ViralCellDetector is developed by BinChen lab. Any questions or feedback can be
addressed to Rama Shankar, PhD, <ramashan@msu.edu> or Bin Chen, PhD, PI,
<Chenbi12@msu.edu>


